+function(t,e,r){"use strict";e.spiedEventsKey=function(t,e){return[r(t).selector,e].toString()},e.getFixtures=function(){return e.currentFixtures_=e.currentFixtures_||new e.Fixtures},e.getStyleFixtures=function(){return e.currentStyleFixtures_=e.currentStyleFixtures_||new e.StyleFixtures},e.Fixtures=function(){this.containerId="jasmine-fixtures",this.fixturesCache_={},this.fixturesPath="spec/javascripts/fixtures"},e.Fixtures.prototype.set=function(t){return this.cleanUp(),this.createContainer_(t)},e.Fixtures.prototype.appendSet=function(t){this.addToContainer_(t)},e.Fixtures.prototype.preload=function(){this.read.apply(this,arguments)},e.Fixtures.prototype.load=function(){this.cleanUp(),this.createContainer_(this.read.apply(this,arguments))},e.Fixtures.prototype.appendLoad=function(){this.addToContainer_(this.read.apply(this,arguments))},e.Fixtures.prototype.read=function(){for(var t=[],e=arguments,r=e.length,n=0;n<r;n++)t.push(this.getFixtureHtml_(e[n]));return t.join("")},e.Fixtures.prototype.clearCache=function(){this.fixturesCache_={}},e.Fixtures.prototype.cleanUp=function(){r("#"+this.containerId).remove()},e.Fixtures.prototype.sandbox=function(t){var e=t||{};return r('<div id="sandbox" />').attr(e)},e.Fixtures.prototype.createContainer_=function(t){var e=r("<div>").attr("id",this.containerId).html(t);return r(document.body).append(e),e},e.Fixtures.prototype.addToContainer_=function(t){var e=r(document.body).find("#"+this.containerId).append(t);e.length||this.createContainer_(t)},e.Fixtures.prototype.getFixtureHtml_=function(t){return"undefined"==typeof this.fixturesCache_[t]&&this.loadFixtureIntoCache_(t),this.fixturesCache_[t]},e.Fixtures.prototype.loadFixtureIntoCache_=function(t){var e=this,n=this.makeFixtureUrl_(t),i="",s=(r.ajax({async:!1,cache:!1,url:n,success:function(t,e,r){i=r.responseText},error:function(t,e,r){throw new Error("Fixture could not be loaded: "+n+" (status: "+e+", message: "+r.message+")")}}),r(r.parseHTML(i,!0)).find("script")||[]);s.each(function(){r.ajax({async:!1,cache:!1,url:r(this).attr("src"),success:function(t,e,r){i+="<script>"+r.responseText+"</script>"},error:function(t,e,r){throw new Error("Script could not be loaded: "+scriptSrc+" (status: "+e+", message: "+r.message+")")}})}),e.fixturesCache_[t]=i},e.Fixtures.prototype.makeFixtureUrl_=function(t){return this.fixturesPath.match("/$")?this.fixturesPath+t:this.fixturesPath+"/"+t},e.Fixtures.prototype.proxyCallTo_=function(t,e){return this[t].apply(this,e)},e.StyleFixtures=function(){this.fixturesCache_={},this.fixturesNodes_=[],this.fixturesPath="spec/javascripts/fixtures"},e.StyleFixtures.prototype.set=function(t){this.cleanUp(),this.createStyle_(t)},e.StyleFixtures.prototype.appendSet=function(t){this.createStyle_(t)},e.StyleFixtures.prototype.preload=function(){this.read_.apply(this,arguments)},e.StyleFixtures.prototype.load=function(){this.cleanUp(),this.createStyle_(this.read_.apply(this,arguments))},e.StyleFixtures.prototype.appendLoad=function(){this.createStyle_(this.read_.apply(this,arguments))},e.StyleFixtures.prototype.cleanUp=function(){for(;this.fixturesNodes_.length;)this.fixturesNodes_.pop().remove()},e.StyleFixtures.prototype.createStyle_=function(t){var e=r("<div></div>").html(t).text(),n=r("<style>"+e+"</style>");this.fixturesNodes_.push(n),r("head").append(n)},e.StyleFixtures.prototype.clearCache=e.Fixtures.prototype.clearCache,e.StyleFixtures.prototype.read_=e.Fixtures.prototype.read,e.StyleFixtures.prototype.getFixtureHtml_=e.Fixtures.prototype.getFixtureHtml_,e.StyleFixtures.prototype.loadFixtureIntoCache_=e.Fixtures.prototype.loadFixtureIntoCache_,e.StyleFixtures.prototype.makeFixtureUrl_=e.Fixtures.prototype.makeFixtureUrl_,e.StyleFixtures.prototype.proxyCallTo_=e.Fixtures.prototype.proxyCallTo_,e.getJSONFixtures=function(){return e.currentJSONFixtures_=e.currentJSONFixtures_||new e.JSONFixtures},e.JSONFixtures=function(){this.fixturesCache_={},this.fixturesPath="spec/javascripts/fixtures/json"},e.JSONFixtures.prototype.load=function(){return this.read.apply(this,arguments),this.fixturesCache_},e.JSONFixtures.prototype.read=function(){for(var t=arguments,e=t.length,r=0;r<e;r++)this.getFixtureData_(t[r]);return this.fixturesCache_},e.JSONFixtures.prototype.clearCache=function(){this.fixturesCache_={}},e.JSONFixtures.prototype.getFixtureData_=function(t){return this.fixturesCache_[t]||this.loadFixtureIntoCache_(t),this.fixturesCache_[t]},e.JSONFixtures.prototype.loadFixtureIntoCache_=function(t){var e=this,n=this.fixturesPath.match("/$")?this.fixturesPath+t:this.fixturesPath+"/"+t;r.ajax({async:!1,cache:!1,dataType:"json",url:n,success:function(r){e.fixturesCache_[t]=r},error:function(t,e,r){throw new Error("JSONFixture could not be loaded: "+n+" (status: "+e+", message: "+r.message+")")}})},e.JSONFixtures.prototype.proxyCallTo_=function(t,e){return this[t].apply(this,e)},e.jQuery=function(){},e.jQuery.browserTagCaseIndependentHtml=function(t){return r("<div/>").append(t).html()},e.jQuery.elementToString=function(t){return r(t).map(function(){return this.outerHTML}).toArray().join(", ")},e.jQuery.matchersClass={};var n={spiedEvents:{},handlers:[]};e.jQuery.events={spyOn:function(t,i){var s=function(){n.spiedEvents[e.spiedEventsKey(t,i)]=e.util.argsToArray(arguments)};return r(t).on(i,s),n.handlers.push(s),{selector:t,eventName:i,handler:s,reset:function(){delete n.spiedEvents[e.spiedEventsKey(t,i)]}}},args:function(t,r){var i=n.spiedEvents[e.spiedEventsKey(t,r)];if(!i)throw"There is no spy for "+r+" on "+t.toString()+". Make sure to create a spy using spyOnEvent.";return i},wasTriggered:function(t,r){return!!n.spiedEvents[e.spiedEventsKey(t,r)]},wasTriggeredWith:function(t,r,n,i){var s=e.jQuery.events.args(t,r).slice(1);return"[object Array]"!==Object.prototype.toString.call(n)&&(s=s[0]),i.equals_(n,s)},wasPrevented:function(t,r){var i=n.spiedEvents[e.spiedEventsKey(t,r)],s=i?i[0]:void 0;return s&&s.isDefaultPrevented()},wasStopped:function(t,r){var i=n.spiedEvents[e.spiedEventsKey(t,r)],s=i?i[0]:void 0;return s&&s.isPropagationStopped()},cleanUp:function(){n.spiedEvents={},n.handlers=[]}};var i={toHaveClass:function(t){return this.actual.hasClass(t)},toHaveCss:function(t){for(var e in t){var r=t[e];if(("auto"!==r||"auto"!==this.actual.get(0).style[e])&&this.actual.css(e)!==r)return!1}return!0},toBeVisible:function(){return this.actual.is(":visible")},toBeHidden:function(){return this.actual.is(":hidden")},toBeSelected:function(){return this.actual.is(":selected")},toBeChecked:function(){return this.actual.is(":checked")},toBeEmpty:function(){return this.actual.is(":empty")},toBeInDOM:function(){return r.contains(document.documentElement,this.actual[0])},toExist:function(){return this.actual.length},toHaveLength:function(t){return this.actual.length===t},toHaveAttr:function(t,e){return s(this.actual.attr(t),e)},toHaveProp:function(t,e){return s(this.actual.prop(t),e)},toHaveId:function(t){return this.actual.attr("id")==t},toHaveHtml:function(t){return this.actual.html()==e.jQuery.browserTagCaseIndependentHtml(t)},toContainHtml:function(t){var r=this.actual.html(),n=e.jQuery.browserTagCaseIndependentHtml(t);return r.indexOf(n)>=0},toHaveText:function(t){var e=r.trim(this.actual.text());return t&&r.isFunction(t.test)?t.test(e):e==t},toContainText:function(t){var e=r.trim(this.actual.text());return t&&r.isFunction(t.test)?t.test(e):e.indexOf(t)!=-1},toHaveValue:function(t){return this.actual.val()===t},toHaveData:function(t,e){return s(this.actual.data(t),e)},toBe:function(t){return this.actual.is(t)},toContain:function(t){return this.actual.find(t).length},toBeMatchedBy:function(t){return this.actual.filter(t).length},toBeDisabled:function(){return this.actual.is(":disabled")},toBeFocused:function(){return this.actual[0]===this.actual[0].ownerDocument.activeElement},toHandle:function(t){var e=r._data(this.actual.get(0),"events");if(!e||!t||"string"!=typeof t)return!1;var n=t.split("."),i=n.shift(),s=n.slice(0).sort(),a=new RegExp("(^|\\.)"+s.join("\\.(?:.*\\.)?")+"(\\.|$)");if(!e[i]||!n.length)return e[i]&&e[i].length>0;for(var o=0;o<e[i].length;o++){var u=e[i][o].namespace;if(a.test(u))return!0}},toHandleWith:function(t,e){for(var n=t.split(".")[0],i=r._data(this.actual.get(0),"events")[n],s=0;s<i.length;s++)if(i[s].handler==e)return!0;return!1}},s=function(t,e){return void 0===e?void 0!==t:t===e},a=function(t){var n=e.Matchers.prototype[t];e.jQuery.matchersClass[t]=function(){if(this.actual&&(this.actual instanceof r||e.isDomNode(this.actual))){this.actual=r(this.actual);var s,a=i[t].apply(this,arguments);return this.actual.get&&(s=this.actual.get()[0])&&!r.isWindow(s)&&"HTML"!==s.tagName&&(this.actual=e.jQuery.elementToString(this.actual)),a}return!!n&&n.apply(this,arguments)}};for(var o in i)a(o);beforeEach(function(){this.addMatchers(e.jQuery.matchersClass),this.addMatchers({toHaveBeenTriggeredOn:function(t){return this.message=function(){return["Expected event "+this.actual+" to have been triggered on "+t,"Expected event "+this.actual+" not to have been triggered on "+t]},e.jQuery.events.wasTriggered(t,this.actual)}}),this.addMatchers({toHaveBeenTriggered:function(){var t=this.actual.eventName,r=this.actual.selector;return this.message=function(){return["Expected event "+t+" to have been triggered on "+r,"Expected event "+t+" not to have been triggered on "+r]},e.jQuery.events.wasTriggered(r,t)}}),this.addMatchers({toHaveBeenTriggeredOnAndWith:function(){var t=arguments[0],r=arguments[1],n=e.jQuery.events.wasTriggered(t,this.actual);return this.message=function(){if(n){var i=e.jQuery.events.args(t,this.actual,r)[1];return["Expected event "+this.actual+" to have been triggered with "+e.pp(r)+"  but it was triggered with "+e.pp(i),"Expected event "+this.actual+" not to have been triggered with "+e.pp(r)+" but it was triggered with "+e.pp(i)]}return["Expected event "+this.actual+" to have been triggered on "+t,"Expected event "+this.actual+" not to have been triggered on "+t]},n&&e.jQuery.events.wasTriggeredWith(t,this.actual,r,this.env)}}),this.addMatchers({toHaveBeenPreventedOn:function(t){return this.message=function(){return["Expected event "+this.actual+" to have been prevented on "+t,"Expected event "+this.actual+" not to have been prevented on "+t]},e.jQuery.events.wasPrevented(t,this.actual)}}),this.addMatchers({toHaveBeenPrevented:function(){var t=this.actual.eventName,r=this.actual.selector;return this.message=function(){return["Expected event "+t+" to have been prevented on "+r,"Expected event "+t+" not to have been prevented on "+r]},e.jQuery.events.wasPrevented(r,t)}}),this.addMatchers({toHaveBeenStoppedOn:function(t){return this.message=function(){return["Expected event "+this.actual+" to have been stopped on "+t,"Expected event "+this.actual+" not to have been stopped on "+t]},e.jQuery.events.wasStopped(t,this.actual)}}),this.addMatchers({toHaveBeenStopped:function(){var t=this.actual.eventName,r=this.actual.selector;return this.message=function(){return["Expected event "+t+" to have been stopped on "+r,"Expected event "+t+" not to have been stopped on "+r]},e.jQuery.events.wasStopped(r,t)}}),e.getEnv().addEqualityTester(function(t,n){if(t instanceof r&&n instanceof r){if(t.size()!=n.size())return e.undefined;if(t.is(n))return!0}return e.undefined})}),afterEach(function(){e.getFixtures().cleanUp(),e.getStyleFixtures().cleanUp(),e.jQuery.events.cleanUp()}),t.readFixtures=function(){return e.getFixtures().proxyCallTo_("read",arguments)},t.preloadFixtures=function(){e.getFixtures().proxyCallTo_("preload",arguments)},t.loadFixtures=function(){e.getFixtures().proxyCallTo_("load",arguments)},t.appendLoadFixtures=function(){e.getFixtures().proxyCallTo_("appendLoad",arguments)},t.setFixtures=function(){return e.getFixtures().proxyCallTo_("set",arguments)},t.appendSetFixtures=function(){e.getFixtures().proxyCallTo_("appendSet",arguments)},t.sandbox=function(t){return e.getFixtures().sandbox(t)},t.spyOnEvent=function(t,r){return e.jQuery.events.spyOn(t,r)},t.preloadStyleFixtures=function(){e.getStyleFixtures().proxyCallTo_("preload",arguments)},t.loadStyleFixtures=function(){e.getStyleFixtures().proxyCallTo_("load",arguments)},t.appendLoadStyleFixtures=function(){e.getStyleFixtures().proxyCallTo_("appendLoad",arguments)},t.setStyleFixtures=function(){e.getStyleFixtures().proxyCallTo_("set",arguments)},t.appendSetStyleFixtures=function(){e.getStyleFixtures().proxyCallTo_("appendSet",arguments)},t.loadJSONFixtures=function(){return e.getJSONFixtures().proxyCallTo_("load",arguments)},t.getJSONFixture=function(t){return e.getJSONFixtures().proxyCallTo_("read",arguments)[t]}}(window,window.jasmine,window.jQuery);